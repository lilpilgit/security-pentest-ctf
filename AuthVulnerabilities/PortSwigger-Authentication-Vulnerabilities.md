# PortSwigger - Authentication Vulnerabilities

https://portswigger.net/web-security/authentication

1. Vulnerabilities in authentication mechanisms:
- Vulns in password-based login
- Vulns in MFA auths
- Vulns in other auth mechanisms 


## Vulnerabilities in password-based login

## Brute-force attacks
When an attacker uses a system of trial and error in an attempt to guess valid credentials. Are tipically automated using wordlists of usernames and passwords.

### Brute-forcing usernames
Using some recognizable patterns (```firstname.lastname@somecompany.com```).
High privileged accounts are created using predictables usernames like ```admin``` or ```administrator```.
Looking at website or webapp or the HTTP response sometimes some emails addresses of high-privileged users are disclosed.


### Brute-forcing passwords
Passwords can similarly be brute-forced, with the difficulty varying based on the strength of the password. Many websites adopt some form of password policy, which forces users to create high-entropy passwords that are, theoretically at least, harder to crack using brute-force alone. This typically involves enforcing passwords with:

- A minimum number of characters
- A mixture of lower and uppercase letters
- At least one special character

However, while high-entropy passwords are difficult for computers alone to crack, we can use a basic knowledge of human behavior to exploit the vulnerabilities that users unwittingly introduce to this system. Rather than creating a strong password with a random combination of characters, users often take a password that they can remember and try to crowbar it into fitting the password policy. For example, if mypassword is not allowed, users may try something like Mypassword1! or Myp4$$w0rd instead.
In cases where the policy requires users to change their passwords on a regular basis, it is also common for users to just make minor, predictable changes to their preferred password. For example, Mypassword1! becomes Mypassword1? or Mypassword2!.
This knowledge of likely credentials and predictable patterns means that brute-force attacks can often be much more sophisticated, and therefore effective, than simply iterating through every possible combination of characters. 

### Username enumeration
Attacker is able to observe changes in the website's behaviour in order to identify whether a given username is valid:
- in a login form when enter a valid username but a wrong password
- in a registration forms when enter a username that is already taken

**Status codes**: during a brute-force attack, the returned HTTP status code is likely to be the same for the vast majority of guesses because most of them will be wrong. If a guess return a **different** status code, this is a strong indication that the username is correct.
**Error messages**: Sometimes the returned error message is different depending on whether both the username AND password are incorrect or only the password was incorrect.
**Response times**: If most of the requests were handled with a similar response time, any that deviate from this suggest that something different was happening behind the scenes. This is another indication that the guessed username might be correct. For example, a website might only check whether the password is correct if the username is valid. This extra step might cause a slight increase in the response time.


